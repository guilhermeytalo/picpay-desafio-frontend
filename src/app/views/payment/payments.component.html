<div class="payments">
  <div class="payments__nav">
    <navbar></navbar>
  </div>

  <div class="payments__content">

    <div class="payments__header">
      <div class="payments__title">
        <span>Meus pagamentos</span>
      </div>

      <button (click)="openAddDialog()" mat-flat-button class="payments__header-add" color="primary">
        ADICIONAR PAGAMENTO
      </button>
    </div>

    <div class="payments__table">
      <div class="payments__filter">
        <span class="payments__search">
          <div class="payments__filter-box">
            <input class="payments__filter-value"  maxlength="25" matInput (keyup)="applyFilter($event)" placeholder="Pesquisar por usuário" #input>
            <mat-icon>search</mat-icon>
          </div>

          <table-filter (filterEvent)="setFilter($event)"></table-filter>
        </span>
        <mat-paginator
          [hidden]="filterStatus"
          [length]="pageSettings.length"
          [pageSize]="pageSettings.limit"
          [showFirstLastButtons]="true"
          [pageSizeOptions]="[5, 10, 25, 100]"
        >
        </mat-paginator>
      </div>

      <div>
        <table mat-table [dataSource]="dataSource" matSort>
          <ng-container matColumnDef="name">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              <table-header
                name="Usuário"
                (click)="changeOrder('name')"
                [order]="orderByColumns['name']"
              >
              </table-header>
            </th>
            <td mat-cell *matCellDef="let row">
              {{row.name}}
              <p *ngIf="row.username">@{{row.username}}</p>
            </td>
          </ng-container>
  
          <ng-container matColumnDef="title">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              <table-header
                name="Título"
                (click)="changeOrder('title')"
                [order]="orderByColumns['title']"
              >
              </table-header>
            </th>
            <td mat-cell *matCellDef="let row">{{row.title}} </td>
          </ng-container>

          <ng-container matColumnDef="date">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              <table-header
                name="Data"
                (click)="changeOrder('date')"
                [order]="orderByColumns['date']"
              >
              </table-header>
            </th>
            <td mat-cell *matCellDef="let row">
              {{formatterService.customDate(row.date)}}
              <p>{{formatterService.hourFromDate(row.date)}}</p>
            </td>
          </ng-container>

          <ng-container matColumnDef="value">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              <table-header
                name="Valor"
                (click)="changeOrder('value')"
                [order]="orderByColumns['value']"
              >
              </table-header>
            </th>
            <td mat-cell *matCellDef="let row">
              {{formatterService.money(row.value)}}
            </td>
          </ng-container>

          <ng-container matColumnDef="isPayed">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              <table-header
                name="Pago"
                (click)="changeOrder('isPayed')"
                [order]="orderByColumns['isPayed']"
              >
              </table-header>
            </th>
            <td mat-cell *matCellDef="let row">
              <mat-checkbox
                class="example-margin"
                [(ngModel)]="row.isPayed"
                (change)="changeValue($event, { payment: row })"
              >
            </mat-checkbox>
            </td>
          </ng-container>

          <ng-container matColumnDef="actions">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> </th>
            <td mat-cell *matCellDef="let row">
              <mat-icon (click)="openAddDialog({ edit: true, payment: row })" class="material-icons-outlined">edit__outline</mat-icon>
              <mat-icon (click)="openRemoveDialog(row.id)">highlight_off</mat-icon>
            </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
  
          <tr class="mat-row" *matNoDataRow>
            <td class="mat-cell" colspan="4">Sem resultados para "{{input.value}}".</td>
          </tr>
        </table>
      </div>
    </div>
  </div>
</div>