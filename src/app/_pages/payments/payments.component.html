<div class="pf-page-header container">
  <div class="pf-page-title">
    <span>Meus pagamentos</span>
  </div>
  <div class="pf-header-buttons">
    <button class="btn btn-primary" (click)="showAddPaymentModal()">
      ADICIONAR PAGAMENTO
    </button>
  </div>
</div>

<div class="pf-payments-list container">
  <div class="pf-payments-header">
    <div id="payments-filter">
      <input
        type="text"
        class="form-control"
        id="search-payment-input"
        placeholder="Pesquisar por usuário, título, data ou valor"
        [(ngModel)]="filterQuery"
        (ngModelChange)="loadPayments()"
      />
    </div>
    <div id="payments-pagination" class="pf-payments-pagination">
      <div class="pf-items-per-page">
        <span>Exibir</span>
        <select
          class="form-select"
          aria-label="Quantidade de itens por página"
          [(ngModel)]="paginationConfig.itemsPerPage"
          (ngModelChange)="changeItemsPerPage()"
        >
          <option *ngFor="let qt of qtOptions">{{ qt }}</option>
        </select>
      </div>
      <pf-pagination-template
        [config]="paginationConfig"
        (changePageEvent)="changePage($event)"
      ></pf-pagination-template>
    </div>
  </div>
  <table class="table table-striped table-hover">
    <thead>
      <tr>
        <th scope="col">
          Usuário
          <button class="btn btn-icon" (click)="toggleSortOrderOptions('name')">
            <i [class]="getOptionOrderIcon('name')"></i>
          </button>
        </th>
        <th scope="col">
          Título
          <button
            class="btn btn-icon"
            (click)="toggleSortOrderOptions('title')"
          >
            <i [class]="getOptionOrderIcon('title')"></i>
          </button>
        </th>
        <th scope="col">
          Data
          <button class="btn btn-icon" (click)="toggleSortOrderOptions('date')">
            <i [class]="getOptionOrderIcon('date')"></i>
          </button>
        </th>
        <th scope="col">
          Valor
          <button
            class="btn btn-icon"
            (click)="toggleSortOrderOptions('value')"
          >
            <i [class]="getOptionOrderIcon('value')"></i>
          </button>
        </th>
        <th scope="col">
          Pago
          <button
            class="btn btn-icon"
            (click)="toggleSortOrderOptions('isPayed')"
          >
            <i [class]="getOptionOrderIcon('isPayed')"></i>
          </button>
        </th>
        <th scope="col"></th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let payment of payments | paginate: paginationConfig">
        <td>{{ payment.name }}</td>
        <td>{{ payment.title }}</td>
        <td>{{ payment.date | date: "dd MMM yyyy":"":"pt-BR" }}</td>
        <td>{{ payment.value | currency: "BRL" }}</td>
        <td>
          <div class="form-check">
            <input
              class="form-check-input"
              type="checkbox"
              [(ngModel)]="payment.isPayed"
              (ngModelChange)="toggleIsPayed(payment)"
            />
          </div>
        </td>
        <td class="text-end">
          <button
            type="button"
            class="btn btn-icon"
            (click)="showEditPaymentModal(payment)"
          >
            <i class="bi bi-pencil"></i>
          </button>
          <button
            type="button"
            class="btn btn-icon"
            (click)="showDeletePaymentModal(payment)"
          >
            <i class="bi bi-x-circle"></i>
          </button>
        </td>
      </tr>
    </tbody>
  </table>
</div>
